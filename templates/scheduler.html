{% extends 'base.html' %}
{% block content %}
<script src="../static/js/vis.min.js"></script>
{% load static %}
<link rel="stylesheet" href="{% static 'css/vis.min.css' %}">
<link rel="stylesheet" href="{% static 'css/scheduler.css' %}">
<div id="starting">
   {% if user.is_superuser %}
	<h1> Scheduler 
		<button class="btn btn-success" data-toggle="modal" data-target="#createReportModal">Create Schedule Report</button>
      <button class="btn btn-success" data-toggle="modal" data-target="#scheduleAutomationModal">Schedule Automation</button>
	</h1>

	<h3 class="error" v-if="message"> ${message} </h3>
	<div id="visualization"></div>
   <h4 class="error" v-if="search_error"> ${search_error} </h4>
	<div class="row">
        <input id = "search_input" class="form-control mr-sm-2" type="text" placeholder="Search" autocomplete="on" v-model="search_term"  aria-label="Search" @blur="onBlur">
        <button class="btn btn-outline-success my-2 my-sm-0 schedule-button" v-on:click.prevent="addGoal()">Add Goal</button>
        <button class="btn btn-outline-success my-2 my-sm-0 schedule-button" v-on:click.prevent="saveTimeline('{{user.id}}')">Save Timeline</button>
    </div>
	<div class='pane'>
	    <div class='side' style="max-width:350px;overflow:auto">
	        <pre id="output"></pre>
	    </div>
	    <div class='side'>
	    	<template v-for="(goal,list_index) in unscheduled_goals">
	    		<template v-for="(value,index) in goal">
	    			<div class="column">
						<tbody>
						<th><h1>${ index }</h1></th>
						<th><button class="btn btn-danger" v-on:click="removeGoal(index)">Remove</button></th>
		    			<ul class="items">
			    			<template v-for="(value2,index2) in value">
								<!-- list_index is index for goal (i.e 0,1,2), index is goalname, index2 is sku names for that goal -->
								<template v-if="index2!='deadline'">
				    				<li draggable="true" class="item" v-on:dragStart="handleDragStart(list_index,index,index2,$event)">
			                			${index2}
			            			</li>
		            			</template>
			    			</template>
						</ul>
						</tbody>
					</div>
	    		</template>
	   	    </template>
	    </div>
	</div>

	<div class="modal fade" id="createReportModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle" aria-hidden="true">
      <div class="modal-dialog" role="document">
         <div class="modal-content">
            <div class="modal-header">
               <h5 class="modal-title" id="exampleModalLongTitle">Create Manufacture Schedule Report</h5>
               <button type="button" class="close" data-dismiss="modal" aria-label="Close">
               <span aria-hidden="true">&times;</span>
               </button>
            </div>
            <form v-on:submit.prevent="createReport('{{user.id}}')">
               <div class="modal-body">
                  <div class="form-group">
                     <label>Manufacturing line*</label>
                     <input
                        type="text"
                        class="form-control"
                        placeholder="Enter Manufacture Line Name"
                        v-model="report.manufacture_line"
                        required="required" >
                  </div>
                  <div class="form-group">
                     <label>Start Date*</label>
                     <input
                        type="date"
                        class="form-control"
                        placeholder="Enter Start Date"
                        v-model="report.start_date"
                        required="required" >
                  </div>
                  <div class="form-group">
                     <label>End Date*</label>
                     <input
                        type="date"
                        class="form-control"
                        placeholder="Enter End Date"
                        v-model="report.end_date"
                        required="required" >
                  </div>
               </div>
               <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                  <button type="submit" class="btn btn-primary">Create Report</button>
               </div>
            </form>
         </div>
      </div>
   </div>

      <div class="modal fade" id="scheduleAutomationModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle" aria-hidden="true">
      <div class="modal-dialog" role="document">
         <div class="modal-content">
            <div class="modal-header">
               <h5 class="modal-title" id="exampleModalLongTitle">Create Manufacture Schedule Report</h5>
               <button type="button" class="close" data-dismiss="modal" aria-label="Close">
               <span aria-hidden="true">&times;</span>
               </button>
            </div>
            <form v-on:submit.prevent="getAutomation()">
               <div class="modal-body">
<!--                   <div class="form-group">
                     <label>Manufacturing Activity*</label>
                     <input
                        type="text"
                        class="form-control"
                        placeholder="Enter Manufacture Activity"
                        v-model="automate.manufacturing_activity"
                        required="required" >
                  </div> -->
                  <div class="form-group">
                     <label>Start Date*</label>
                     <input
                        type="date"
                        class="form-control"
                        placeholder="Enter Start Date"
                        v-model="automate.start_date"
                        required="required" >
                  </div>
                  <div class="form-group">
                     <label>End Date*</label>
                     <input
                        type="date"
                        class="form-control"
                        placeholder="Enter End Date"
                        v-model="automate.end_date"
                        required="required" >
                  </div>
               </div>
               <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                  <button type="submit" class="btn btn-primary">Create Report</button>
               </div>
            </form>
         </div>
      </div>
   </div>

</div>
{% endif %}
<script src="../static/js/scheduler.js"></script>
{% endblock %}